<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>French Grammar Adventure</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <style>
        @keyframes floatIn {
            0% {
                transform: translateY(20px);
                opacity: 0;
            }
            100% {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes glow {
            0% {
                box-shadow: 0 0 5px var(--neon-green);
            }
            50% {
                box-shadow: 0 0 20px var(--neon-green);
            }
            100% {
                box-shadow: 0 0 5px var(--neon-green);
            }
        }

        :root {
            --dark-bg: #001a00;
            --neon-green: #39FF14;
            --card-bg: rgba(0, 26, 0, 0.95);
            --text-color: #ffffff;
            --border-color: rgba(57, 255, 20, 0.3);
            --neon-green-dim: rgba(57, 255, 20, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(57, 255, 20, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(57, 255, 20, 0.1) 0%, transparent 50%);
        }

        .container {
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
        }

        h1 {
            color: var(--neon-green);
            text-align: center;
            margin: 1.5rem 0;
            font-size: 2.5rem;
            text-shadow: 0 0 10px rgba(57, 255, 20, 0.5);
        }

        .game-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
            position: relative;
            box-shadow: 0 0 20px rgba(177, 74, 237, 0.2);
        }

        .level-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 2rem;
        }

        .level-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .level-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(57, 255, 20, 0.3);
            border-color: var(--neon-green);
        }

        .level-card h2 {
            color: var(--neon-green);
            margin-bottom: 1rem;
        }

        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 2rem 0;
            justify-content: center;
        }

        .word-piece {
            background-color: var(--neon-green-dim);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 8px 15px;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

        .word-piece:hover {
            background-color: rgba(177, 74, 237, 0.2);
            transform: translateY(-2px);
        }

        .word-piece.selected {
            background-color: var(--neon-green);
            color: var(--dark-bg);
        }

        .sentence-builder {
            min-height: 60px;
            border: 2px dashed var(--border-color);
            border-radius: 10px;
            padding: 15px;
            margin: 1rem 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .check-button {
            background-color: var(--neon-green);
            color: var(--dark-bg);
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            display: block;
            margin: 2rem auto;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .check-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(57, 255, 20, 0.3);
        }

        .feedback {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin-top: 1rem;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .feedback.correct {
            background-color: rgba(46, 213, 115, 0.1);
            border: 1px solid rgba(46, 213, 115, 0.3);
            color: #2ed573;
            opacity: 1;
        }

        .feedback.incorrect {
            background-color: rgba(255, 71, 87, 0.1);
            border: 1px solid rgba(255, 71, 87, 0.3);
            color: #ff4757;
            opacity: 1;
        }

        .hint {
            font-style: italic;
            color: rgba(255, 255, 255, 0.7);
            text-align: center;
            margin-top: 1rem;
        }

        .progress-bar {
            height: 8px;
            width: 100%;
            background-color: var(--neon-green-dim);
            border-radius: 4px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress {
            height: 100%;
            background-color: var(--neon-green);
            transition: width 0.3s ease;
        }

        .score-display {
            text-align: center;
            color: var(--neon-green);
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .grammar-tip {
            background-color: rgba(177, 74, 237, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        .grammar-tip h3 {
            color: var(--neon-green);
            margin-bottom: 0.5rem;
        }

        .achievement-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--card-bg);
            border: 2px solid var(--neon-green);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 1000;
            transform: translateX(120%);
            transition: transform 0.3s ease-in-out;
            max-width: 350px;
        }

        .achievement-notification.show {
            transform: translateX(0);
        }

        .achievement-icon {
            font-size: 2rem;
            animation: pulse 1s infinite;
        }

        .achievement-details h3 {
            color: var(--neon-green);
            margin-bottom: 5px;
        }

        .achievement-reward {
            color: var(--neon-green);
            font-weight: bold;
            margin-top: 5px;
        }

        .level-card {
            animation: floatIn 0.5s ease-out;
        }

        .word-piece {
            animation: glow 2s infinite;
            transition: all 0.3s ease;
        }

        .word-piece:hover {
            animation: none;
            transform: scale(1.1);
            background-color: var(--neon-green);
            color: var(--dark-bg);
        }

        .timer-display {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: var(--card-bg);
            border: 2px solid var(--neon-green);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--neon-green);
            animation: glow 2s infinite;
        }

        .stats-display {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--card-bg);
            border: 2px solid var(--neon-green);
            border-radius: 10px;
            padding: 10px;
            text-align: right;
        }

        .stats-display .stars {
            color: var(--neon-green);
            font-size: 1.2rem;
            font-weight: bold;
        }

        .streak-counter {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 5px;
        }

        .streak-flame {
            color: var(--neon-green);
            animation: pulse 1s infinite;
        }

        .combo-multiplier {
            position: absolute;
            top: -20px;
            right: -20px;
            background-color: var(--neon-green);
            color: var(--dark-bg);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            animation: pulse 1s infinite;
        }

        .xp-gain {
            position: absolute;
            color: var(--neon-green);
            font-weight: bold;
            pointer-events: none;
            animation: floatUp 1s ease-out forwards;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            100% {
                transform: translateY(-50px);
                opacity: 0;
            }
        }

        @media (max-width: 600px) {
            .word-bank {
                gap: 8px;
            }

            .word-piece {
                font-size: 0.9rem;
                padding: 6px 12px;
            }

            .game-card {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>French Grammar Adventure</h1>
        <p style="text-align: center; color: var(--neon-purple); margin-bottom: 2rem;">
            Build correct French sentences and master grammar through fun exercises! 🎮
        </p>

        <div id="game-content">
            <!-- Content will be dynamically inserted here -->
        </div>
    </div>

    <script>
        // Game data structure
        const gameData = {
            beginner: {
                title: "Basic Sentences",
                description: "Learn to build simple French sentences",
                exercises: [
                    {
                        instruction: "Build a basic sentence using subject + verb (to be) + adjective",
                        words: ["Je", "suis", "Tu", "es", "heureux", "heureuse", "français", "française"],
                        correctSentences: [
                            "Je suis heureux",
                            "Je suis heureuse",
                            "Tu es heureux",
                            "Tu es heureuse",
                            "Je suis français",
                            "Je suis française",
                            "Tu es français",
                            "Tu es française"
                        ],
                        hint: "Start with a subject (Je/Tu), then use the correct form of 'être' (suis/es)",
                        grammarTip: {
                            title: "Subject-Verb Agreement",
                            content: "'Je' always uses 'suis', while 'Tu' always uses 'es'. The adjective should match the gender of the speaker."
                        }
                    },
                    {
                        instruction: "Create a sentence with subject + verb + article + noun",
                        words: ["Je", "aime", "le", "la", "chat", "chien", "maison", "livre"],
                        correctSentences: [
                            "Je aime le chat",
                            "Je aime le chien",
                            "Je aime la maison",
                            "Je aime le livre"
                        ],
                        hint: "Use 'le' for masculine nouns and 'la' for feminine nouns",
                        grammarTip: {
                            title: "Articles in French",
                            content: "'Le' is used for masculine nouns (le chat, le chien, le livre) while 'la' is used for feminine nouns (la maison)."
                        }
                    }
                ]
            },
            intermediate: {
                title: "Complex Structures",
                description: "Practice more advanced sentence patterns",
                exercises: [
                    {
                        instruction: "Build a sentence using subject + verb + preposition + article + noun",
                        words: ["Je", "vais", "à", "la", "le", "école", "parc", "restaurant", "plage"],
                        correctSentences: [
                            "Je vais à la plage",
                            "Je vais à la école",
                            "Je vais au parc",
                            "Je vais au restaurant"
                        ],
                        hint: "Remember that 'à + le' becomes 'au'",
                        grammarTip: {
                            title: "Preposition Contractions",
                            content: "When 'à' is followed by 'le', they combine to form 'au'. However, 'à + la' stays as two separate words."
                        }
                    },
                    {
                        instruction: "Create a sentence with subject + negative verb + object",
                        words: ["Je", "ne", "pas", "aime", "le", "la", "café", "thé", "soupe"],
                        correctSentences: [
                            "Je ne aime pas le café",
                            "Je ne aime pas le thé",
                            "Je ne aime pas la soupe"
                        ],
                        hint: "Place 'ne' before the verb and 'pas' after it",
                        grammarTip: {
                            title: "Negative Sentences",
                            content: "In French, negation uses two parts: 'ne' before the verb and 'pas' after it. Example: Je ne mange pas (I don't eat)."
                        }
                    }
                ]
            },
            advanced: {
                title: "Complex Tenses",
                description: "Master past and future tenses",
                exercises: [
                    {
                        instruction: "Construct a sentence in the passé composé (past tense)",
                        words: ["J'", "ai", "mangé", "bu", "le", "la", "pizza", "sandwich", "soupe"],
                        correctSentences: [
                            "J' ai mangé la pizza",
                            "J' ai mangé le sandwich",
                            "J' ai bu la soupe"
                        ],
                        hint: "Use avoir (ai) + past participle (mangé/bu)",
                        grammarTip: {
                            title: "Passé Composé",
                            content: "The passé composé is formed with avoir/être + past participle. Most verbs use avoir, like 'J'ai mangé' (I ate)."
                        }
                    },
                    {
                        instruction: "Create a sentence in the future proche (near future)",
                        words: ["Je", "vais", "aller", "visiter", "à", "la", "le", "Paris", "musée", "plage"],
                        correctSentences: [
                            "Je vais aller à Paris",
                            "Je vais visiter le musée",
                            "Je vais aller à la plage"
                        ],
                        hint: "Use 'aller' (vais) + infinitive",
                        grammarTip: {
                            title: "Future Proche",
                            content: "The near future is formed with 'aller' + infinitive. Example: 'Je vais manger' (I am going to eat)."
                        }
                    }
                ]
            }
        };

        // Game state and achievements system
        let currentLevel = null;
        let currentExercise = 0;
        let score = 0;
        let selectedWords = [];
        let gameStats = {
            totalScore: 0,
            perfectLevels: 0,
            currentStreak: 0,
            longestStreak: 0,
            achievements: [],
            stars: 0,
            lastPlayDate: null,
            exercisesCompleted: 0,
            hintsUsed: 0
        };

        // Achievement definitions
        const achievements = {
            perfectBeginner: {
                id: 'perfectBeginner',
                title: '🌟 Perfect Beginner',
                description: 'Complete beginner level with 100% accuracy',
                reward: 50,
                icon: '🎯'
            },
            streakMaster: {
                id: 'streakMaster',
                title: '🔥 Streak Master',
                description: 'Maintain a 5-day streak',
                reward: 100,
                icon: '🔥'
            },
            grammarNinja: {
                id: 'grammarNinja',
                title: '⚔️ Grammar Ninja',
                description: 'Complete 10 exercises without mistakes',
                reward: 75,
                icon: '⚔️'
            },
            speedDemon: {
                id: 'speedDemon',
                title: '⚡ Speed Demon',
                description: 'Complete an exercise in under 10 seconds',
                reward: 30,
                icon: '⚡'
            },
            noHint: {
                id: 'noHint',
                title: '🧠 Memory Master',
                description: 'Complete a level without using hints',
                reward: 40,
                icon: '🧠'
            }
        };

        // Load game stats from localStorage
        function loadGameStats() {
            const savedStats = localStorage.getItem('frenchGrammarStats');
            if (savedStats) {
                gameStats = JSON.parse(savedStats);
            }
            updateStreak();
        }

        // Save game stats to localStorage
        function saveGameStats() {
            localStorage.setItem('frenchGrammarStats', JSON.stringify(gameStats));
        }

        // Update daily streak
        function updateStreak() {
            const today = new Date().toDateString();
            if (gameStats.lastPlayDate !== today) {
                if (isConsecutiveDay(gameStats.lastPlayDate)) {
                    gameStats.currentStreak++;
                    gameStats.longestStreak = Math.max(gameStats.currentStreak, gameStats.longestStreak);
                    if (gameStats.currentStreak === 5) {
                        unlockAchievement('streakMaster');
                    }
                } else {
                    gameStats.currentStreak = 1;
                }
                gameStats.lastPlayDate = today;
                saveGameStats();
            }
        }

        // Check if the last play date was yesterday
        function isConsecutiveDay(lastPlayDate) {
            if (!lastPlayDate) return false;
            const last = new Date(lastPlayDate);
            const today = new Date();
            const diffTime = Math.abs(today - last);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays === 1;
        }

        // Unlock achievement and show notification
        function unlockAchievement(achievementId) {
            if (!gameStats.achievements.includes(achievementId)) {
                gameStats.achievements.push(achievementId);
                gameStats.stars += achievements[achievementId].reward;
                saveGameStats();
                
                showAchievementNotification(achievements[achievementId]);
            }
        }

        // Show floating achievement notification
        function showAchievementNotification(achievement) {
            const notification = document.createElement('div');
            notification.className = 'achievement-notification';
            notification.innerHTML = `
                <div class="achievement-icon">${achievement.icon}</div>
                <div class="achievement-details">
                    <h3>${achievement.title}</h3>
                    <p>${achievement.description}</p>
                    <p class="achievement-reward">+${achievement.reward} ⭐</p>
                </div>
            `;
            document.body.appendChild(notification);

            // Add animation class after a brief delay
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);

            // Remove notification after animation
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 500);
            }, 3000);
        }

        // Timer variables
        let exerciseStartTime;
        let exerciseTimer;

        // Show level selection screen
        function showLevelSelection() {
            loadGameStats();
            const content = `
                <div class="stats-display">
                    <div class="stars">⭐ ${gameStats.stars}</div>
                    <div class="streak-counter">
                        <span class="streak-flame">🔥</span>
                        <span>${gameStats.currentStreak} days</span>
                    </div>
                </div>

                <div class="level-selection">
                    ${Object.entries(gameData).map(([level, data]) => `
                        <div class="level-card" onclick="startLevel('${level}')">
                            <h2>${data.title}</h2>
                            <p>${data.description}</p>
                            ${gameStats.achievements.includes('perfect' + level.charAt(0).toUpperCase() + level.slice(1)) ? 
                                '<div class="achievement-badge">🏆</div>' : ''}
                            <div class="level-stats">
                                <span>⭐ Best: ${gameStats[level + 'HighScore'] || 0}%</span>
                                <span>🎯 Completed: ${gameStats[level + 'Completed'] || 0}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>

                <div class="achievements-showcase">
                    <h2>🏆 Achievements</h2>
                    <div class="achievements-grid">
                        ${Object.values(achievements).map(achievement => `
                            <div class="achievement-card ${gameStats.achievements.includes(achievement.id) ? 'unlocked' : 'locked'}">
                                <div class="achievement-icon">${achievement.icon}</div>
                                <div class="achievement-info">
                                    <h3>${achievement.title}</h3>
                                    <p>${achievement.description}</p>
                                    <span class="achievement-reward">⭐ ${achievement.reward}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('game-content').innerHTML = content;
        }

        // Start selected level
        function startLevel(level) {
            currentLevel = level;
            currentExercise = 0;
            score = 0;
            displayExercise();
        }

        // Display current exercise
        function startExerciseTimer() {
            exerciseStartTime = Date.now();
            if (exerciseTimer) clearInterval(exerciseTimer);
            
            const timerDisplay = document.createElement('div');
            timerDisplay.className = 'timer-display';
            timerDisplay.id = 'timer';
            document.body.appendChild(timerDisplay);
            
            exerciseTimer = setInterval(() => {
                const elapsed = Math.floor((Date.now() - exerciseStartTime) / 1000);
                timerDisplay.textContent = elapsed + 's';
            }, 1000);
        }

        function stopExerciseTimer() {
            if (exerciseTimer) {
                clearInterval(exerciseTimer);
                const timerDisplay = document.getElementById('timer');
                if (timerDisplay) {
                    document.body.removeChild(timerDisplay);
                }
            }
            return Math.floor((Date.now() - exerciseStartTime) / 1000);
        }

        function showXPGain(element, amount) {
            const xpText = document.createElement('div');
            xpText.className = 'xp-gain';
            xpText.textContent = `+${amount} XP`;
            xpText.style.left = `${element.offsetLeft + element.offsetWidth / 2}px`;
            xpText.style.top = `${element.offsetTop}px`;
            document.body.appendChild(xpText);
            
            setTimeout(() => {
                document.body.removeChild(xpText);
            }, 1000);
        }

        function displayExercise() {
            const exercise = gameData[currentLevel].exercises[currentExercise];
            const progressPercent = ((currentExercise) / gameData[currentLevel].exercises.length) * 100;
            
            // Start the timer for this exercise
            startExerciseTimer();
            
            const content = `
                <div class="game-card">
                    <button class="check-button" style="margin: 0 0 1rem 0;" onclick="showLevelSelection()">← Back to Levels</button>
                    
                    <div class="score-display">
                        Level: ${currentLevel.charAt(0).toUpperCase() + currentLevel.slice(1)} | 
                        Exercise ${currentExercise + 1}/${gameData[currentLevel].exercises.length} | 
                        Score: ${score}
                    </div>
                    
                    <div class="progress-bar">
                        <div class="progress" style="width: ${progressPercent}%"></div>
                    </div>

                    <h3 style="text-align: center; color: var(--neon-purple); margin-bottom: 1rem;">
                        ${exercise.instruction}
                    </h3>

                    <div class="grammar-tip">
                        <h3>📝 Grammar Tip</h3>
                        <p>${exercise.grammarTip.content}</p>
                    </div>

                    <div class="sentence-builder" id="sentence-builder">
                        ${selectedWords.map(word => `
                            <div class="word-piece selected" onclick="removeWord('${word}')">${word}</div>
                        `).join('')}
                    </div>

                    <div class="word-bank">
                        ${exercise.words.map(word => `
                            <div class="word-piece" onclick="addWord('${word}')">${word}</div>
                        `).join('')}
                    </div>

                    <button class="check-button" onclick="checkSentence()">Check Sentence</button>

                    <div id="feedback" class="feedback"></div>

                    <p class="hint">💡 Hint: ${exercise.hint}</p>
                </div>
            `;
            
            document.getElementById('game-content').innerHTML = content;
        }

        // Add word to sentence
        function addWord(word) {
            selectedWords.push(word);
            displayExercise();
        }

        // Remove word from sentence
        function removeWord(word) {
            const index = selectedWords.indexOf(word);
            if (index > -1) {
                selectedWords.splice(index, 1);
            }
            displayExercise();
        }

        // Check if sentence is correct
        function checkSentence() {
            const exercise = gameData[currentLevel].exercises[currentExercise];
            const sentence = selectedWords.join(' ');
            const feedback = document.getElementById('feedback');
            const timeTaken = stopExerciseTimer();
            
            if (exercise.correctSentences.includes(sentence)) {
                // Calculate bonus points based on speed
                let speedBonus = 0;
                if (timeTaken < 10) {
                    speedBonus = 50;
                    unlockAchievement('speedDemon');
                } else if (timeTaken < 20) {
                    speedBonus = 30;
                }

                // Calculate streak bonus
                const streakBonus = Math.min(Math.floor(gameStats.currentStreak / 2) * 10, 50);

                // Total XP gain
                const xpGain = 100 + speedBonus + streakBonus;
                gameStats.stars += xpGain;

                // Update stats
                gameStats.exercisesCompleted++;
                if (gameStats.exercisesCompleted >= 10 && !gameStats.achievements.includes('grammarNinja')) {
                    unlockAchievement('grammarNinja');
                }

                feedback.innerHTML = `
                    <div style="position: relative;">
                        Correct! 🎉 Perfect grammar!
                        <div class="combo-multiplier">x${Math.floor(gameStats.currentStreak/2 + 1)}</div>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.9em;">
                        Base XP: +100
                        ${speedBonus ? `<br>Speed Bonus: +${speedBonus}` : ''}
                        ${streakBonus ? `<br>Streak Bonus: +${streakBonus}` : ''}
                        <br><strong>Total: +${xpGain} XP</strong>
                    </div>
                `;
                feedback.className = "feedback correct";
                score++;
                
                // Show floating XP gain
                showXPGain(feedback, xpGain);
                
                setTimeout(() => {
                    selectedWords = [];
                    if (currentExercise < gameData[currentLevel].exercises.length - 1) {
                        currentExercise++;
                        displayExercise();
                    } else {
                        showResults();
                    }
                }, 2000);
            } else {
                feedback.textContent = "Not quite right. Try again! 🤔";
                feedback.className = "feedback incorrect";
                gameStats.currentStreak = 0;
                startExerciseTimer(); // Restart timer for next attempt
            }
        }

        // Show final results
        function showResults() {
            const totalExercises = gameData[currentLevel].exercises.length;
            const percentage = Math.round((score / totalExercises) * 100);
            
            let resultMessage;
            if (percentage >= 90) {
                resultMessage = "Magnifique! You're a grammar master! 🌟";
            } else if (percentage >= 70) {
                resultMessage = "Très bien! Keep practicing! 👏";
            } else if (percentage >= 50) {
                resultMessage = "Pas mal! You're getting there! 💪";
            } else {
                resultMessage = "Keep studying! Practice makes perfect! 📚";
            }
            
            const content = `
                <div class="game-card">
                    <h2 style="text-align: center; color: var(--neon-purple); margin-bottom: 1.5rem;">
                        Level Complete!
                    </h2>
                    
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <div style="font-size: 4rem; color: var(--neon-purple); margin-bottom: 0.5rem;">
                            ${percentage}%
                        </div>
                        <p>${resultMessage}</p>
                        <p style="margin-top: 1rem;">
                            You got ${score} out of ${totalExercises} exercises correct.
                        </p>
                    </div>
                    
                    <div style="display: flex; justify-content: center; gap: 15px;">
                        <button onclick="showLevelSelection()" class="check-button" style="margin: 0;">
                            Choose Another Level
                        </button>
                        <button onclick="startLevel(currentLevel)" class="check-button" style="margin: 0; background-color: var(--neon-purple-dim); color: var(--neon-purple);">
                            Retry Level
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('game-content').innerHTML = content;
        }

        // Initialize game
        window.addEventListener('DOMContentLoaded', showLevelSelection);
    </script>
</body>
</html>
